<% if @last_game %>
  <div class="row random_color lighten-5 z-depth-1">
    <div class="container">
      <div class="row">
        <div class="col s12 center-align">
            <h3>Game Over. You scored <strong><%=@last_game.score%></strong> <%=settings.genres[@last_game.genre].downcase%> points.</h3>

            <p class="flow-text">
                  <a href="javascript:shareScoreToFacebook('I scored <%=@last_game.score%> <%=settings.genres[@last_game.genre].downcase%> points on picktun.es!');">Share your score on Facebook</a>
            </p>
        </div>
      </div>
    </div>
  </div>
<% end %>

<div class="container" style="margin-top:5%">
  <div class="row">
    <div class="col s12">
      <div class="left">
        <h4>Top Players</h4>
      </div>
      <div class="right">
	<a class="waves-effect waves-light btn" href="/">Play Again</a>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col s12">
      <div class="scores" id="scoresList"></div>
    </div>
  </div>
</div>

<script id="scoresListTemplate" type="text/x-jquery-tmpl">
  {{each(genre,games) scores}}
    <div class="card-panel random_color lighten-4">
      <h5><strong>${genre}</strong></h5>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>NAME</th>
            <th>SCORE</th>
            <th>DATE</th>
          </tr>
        </thead>
        <tbody>
          {{each games}}
            <tr class="${last_game_id == id ? 'yellow lighten-5' : ''}">
              <td><strong>${index}</strong></td>
              <td>${username}</td>
              <td style="text-align:center;"><strong>${score}</strong></td>
              <td>${created_at}</td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  {{/each}}
</script>


<script>
$(document).ready(function() {
	$.get("/scores.json", function(data) {
		$("#scoresList").html($("#scoresListTemplate").tmpl({
			scores: data,
			last_game_id: <%=@last_game ? @last_game.id : 'null'%>
		}));
		$('.random_color').each(function() {
			$(this).addClass(Colors.getRandom());
		});
	});
});
</script>
